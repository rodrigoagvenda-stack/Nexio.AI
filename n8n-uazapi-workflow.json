{
  "name": "UAZapi - Envio Manual de Mensagens",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "send-manual-message",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-trigger",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [250, 300],
      "webhookId": "a253246d-00e9-4288-88ff-974fbe42aa50"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.item.json;\nconst messageType = data.messageType;\nconst urlInstancia = data.url_instancia;\nconst token = data.token;\nconst number = data.number;\n\nlet endpoint, body;\n\nswitch (messageType) {\n  case 'text':\n    endpoint = `${urlInstancia}/send/text`;\n    body = {\n      number: number,\n      text: data.text\n    };\n    break;\n  \n  case 'image':\n    endpoint = `${urlInstancia}/send/image`;\n    body = {\n      number: number,\n      url: data.mediaUrl,\n      caption: data.caption || ''\n    };\n    break;\n  \n  case 'document':\n    endpoint = `${urlInstancia}/send/document`;\n    body = {\n      number: number,\n      url: data.mediaUrl,\n      filename: data.filename || 'document'\n    };\n    break;\n  \n  case 'audio':\n    endpoint = `${urlInstancia}/send/audio`;\n    body = {\n      number: number,\n      url: data.mediaUrl\n    };\n    break;\n  \n  case 'sticker':\n    endpoint = `${urlInstancia}/send/sticker`;\n    body = {\n      number: number,\n      url: data.mediaUrl\n    };\n    break;\n  \n  case 'reaction':\n    endpoint = `${urlInstancia}/message/react`;\n    body = {\n      id: data.messageId,\n      text: data.emoji,\n      number: number\n    };\n    break;\n  \n  default:\n    throw new Error(`Tipo de mensagem inválido: ${messageType}`);\n}\n\n// Faz a requisição para UAZapi\nconst response = await $http.request({\n  method: 'POST',\n  url: endpoint,\n  headers: {\n    'token': token,\n    'Content-Type': 'application/json'\n  },\n  body: body,\n  json: true\n});\n\nreturn {\n  json: {\n    success: true,\n    message: 'Mensagem enviada com sucesso',\n    uazapi_response: response\n  }\n};"
      },
      "id": "send-to-uazapi",
      "name": "Send to UAZapi",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [450, 300]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}"
      },
      "id": "respond-success",
      "name": "Responder Sucesso",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [650, 300]
    }
  ],
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Send to UAZapi",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send to UAZapi": {
      "main": [
        [
          {
            "node": "Responder Sucesso",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {},
  "staticData": null,
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2025-12-29T00:00:00.000Z",
  "versionId": "1"
}
